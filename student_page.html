<!DOCTYPE html>
<html lang="ta">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>மாணவர் பக்கம்</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <h1>மாணவர் பக்கம்</h1>
    </header>
    <main>
      <div id="student-content" class="container">
        <!-- Questions and answer boxes will be displayed here -->
      </div>
      <button style="width: 100px; padding: 10px;" id="submitAnswers">சமர்ப்பி</button>
      <div id="toast">The Given Time is Over</div>
    </main>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const studentQuestionsContainer =
          document.getElementById("student-content");
        const assessmentData = JSON.parse(
          localStorage.getItem("assessmentData")
        );

        if (!assessmentData) {
          studentQuestionsContainer.innerHTML =
            "<p>தற்போது கேள்விகள் எதுவும் கிடைக்கவில்லை.</p>";
          return;
        }

        // Display MCQs
        if (assessmentData.mcqs.length > 0) {
          const mcqSection = document.createElement("div");
          mcqSection.innerHTML = "<h2>பல தேர்வு கேள்விகள்</h2>";
          assessmentData.mcqs.forEach((mcq, index) => {
            const mcqForm = document.createElement("div");
            mcqForm.innerHTML = `
                        <p>${index + 1}. ${mcq.question}</p>
                        <label><input type="radio" name="mcq-${index}" value="A"> ${
              mcq.options.A
            }</label><br>
                        <label><input type="radio" name="mcq-${index}" value="B"> ${
              mcq.options.B
            }</label><br>
                        <label><input type="radio" name="mcq-${index}" value="C"> ${
              mcq.options.C
            }</label><br>
                        <label><input type="radio" name="mcq-${index}" value="D"> ${
              mcq.options.D
            }</label>
                    `;
            mcqSection.appendChild(mcqForm);
          });
          studentQuestionsContainer.appendChild(mcqSection);
        }

        // Display Short Answer Questions
        if (assessmentData.shortAnswers.length > 0) {
          const shortAnswerSection = document.createElement("div");
          shortAnswerSection.innerHTML = "<h2>சுருக்கமான பதில் கேள்விகள்</h2>";
          assessmentData.shortAnswers.forEach((shortAnswer, index) => {
            const shortAnswerForm = document.createElement("div");
            shortAnswerForm.innerHTML = `
                        <p>${index + 1}. ${shortAnswer.question}</p>
                        <p class="anss">பதில்களை கீழே எழுதுங்கள்:↓</p>
                        <p class="input-p" contenteditable="true" placeholder="உங்கள் பதிலை உள்ளிடவும்" name="short-answer-${index}"></p>
                    `;
            shortAnswerSection.appendChild(shortAnswerForm);
          });
          studentQuestionsContainer.appendChild(shortAnswerSection);
        }

        // Display Long Answer Questions
        if (assessmentData.longAnswers.length > 0) {
          const longAnswerSection = document.createElement("div");
          longAnswerSection.innerHTML = "<h2>நீண்ட பதில் கேள்விகள்</h2>";
          assessmentData.longAnswers.forEach((longAnswer, index) => {
            const longAnswerForm = document.createElement("div");
            longAnswerForm.innerHTML = `
                        <p>${index + 1}. ${longAnswer.question}</p>
                         <p class="anss">பதில்களை கீழே எழுதுங்கள்:↓</p>
                        <p class="input-p" contenteditable="true" placeholder="உங்கள் பதிலை உள்ளிடவும்" name="long-answer-${index}"></p>
                    `;
            longAnswerSection.appendChild(longAnswerForm);
          });
          studentQuestionsContainer.appendChild(longAnswerSection);
        }

        // Handle answer submission
        document
          .getElementById("submitAnswers")
          .addEventListener("click", () => {
            const studentAnswers = {
              mcqs: [],
              shortAnswers: [],
              longAnswers: [],
            };

            // Collect MCQ answers
            assessmentData.mcqs.forEach((mcq, index) => {
              const selectedOption = document.querySelector(
                `input[name="mcq-${index}"]:checked`
              );
              studentAnswers.mcqs.push({
                question: mcq.question,
                selectedAnswer: selectedOption
                  ? selectedOption.value
                  : "No answer",
              });
            });

            // Collect short answer responses
            assessmentData.shortAnswers.forEach((shortAnswer, index) => {
              const shortAnswerText = document.querySelector(
                `p[name="short-answer-${index}"]`
              ).innerText;
              studentAnswers.shortAnswers.push({
                question: shortAnswer.question,
                answer: shortAnswerText || "No answer",
              });
            });

            // Collect long answer responses
            assessmentData.longAnswers.forEach((longAnswer, index) => {
              const longAnswerText = document.querySelector(
                `p[name="long-answer-${index}"]`
              ).innerText;
              studentAnswers.longAnswers.push({
                question: longAnswer.question,
                answer: longAnswerText || "No answer",
              });
            });

            // You can now submit studentAnswers to the server or save it locally
            console.log(studentAnswers); // For debugging, replace this with actual submission logic

            // Show success message
            alert("பதில்கள் வெற்றிகரமாக சமர்ப்பிக்கப்பட்டன!");
          });
      });
      document.addEventListener("DOMContentLoaded", () => {
        const studentQuestionsContainer =
          document.getElementById("student-content");
        const assessmentData = JSON.parse(
          localStorage.getItem("assessmentData")
        );

        if (!assessmentData) {
          studentQuestionsContainer.innerHTML =
            "<p>தற்போது கேள்விகள் எதுவும் கிடைக்கவில்லை.</p>";
          return;
        }

        // Display Duration
      // Display Duration
const duration = assessmentData.duration * 60; // Convert to seconds
const durationElement = document.createElement("div");
durationElement.innerHTML = `<h3>காலம்: ${assessmentData.duration} நிமிடங்கள்</h3>`;

// Countdown Timer
let timeLeft = duration;
const timerElement = document.createElement("div");
timerElement.innerHTML = `<h4>மீதமுள்ள நேரம்: <span id="timer">${formatTime(
  timeLeft
)}</span></h4>`;

// Insert the duration and timer at the top of the container
studentQuestionsContainer.insertBefore(timerElement, studentQuestionsContainer.firstChild);
studentQuestionsContainer.insertBefore(durationElement, studentQuestionsContainer.firstChild);


        const timerInterval = setInterval(() => {
          timeLeft--;
          timerElement.querySelector("#timer").innerText = formatTime(timeLeft);

          if (timeLeft <= 0) {
            clearInterval(timerInterval);
            showToast("The Given Time is Over");
            setTimeout(() => {
              // Optionally, redirect or close the page
              alert("Time is up! Submitting your answers.");
              // Here you can submit the answers automatically if needed
              window.close(); // This may not work in all browsers for security reasons
            }, 3000); // Show toast for 3 seconds before closing
          }
        }, 1000);

        // Display MCQs, Short Answers, and Long Answers...
        // (Your existing question display code goes here)

        // Handle answer submission
        document
          .getElementById("submitAnswers")
          .addEventListener("click", () => {
            // Your existing answer collection code goes here
          });
      });

      function formatTime(seconds) {
        const minutes = Math.floor(seconds / 60);
        const secs = seconds % 60;
        return `${minutes}:${secs < 10 ? "0" : ""}${secs}`;
      }

      function showToast(message) {
        const toast = document.getElementById("toast");
        toast.innerText = message;
        toast.className = "show";
        setTimeout(() => {
          toast.className = toast.className.replace("show", "");
        }, 3000);
      }
    </script>
  </body>
</html>
